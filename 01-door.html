<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>01: Door | dcl-escape-room-tutorial</title>
    <meta name="description" content="Decentraland tutorial">
    
    
    <link rel="preload" href="/dcl-escape-room-tutorial/assets/css/0.styles.88479a94.css" as="style"><link rel="preload" href="/dcl-escape-room-tutorial/assets/js/app.70dca567.js" as="script"><link rel="preload" href="/dcl-escape-room-tutorial/assets/js/2.709dec3e.js" as="script"><link rel="preload" href="/dcl-escape-room-tutorial/assets/js/6.dcdbada1.js" as="script"><link rel="prefetch" href="/dcl-escape-room-tutorial/assets/js/10.60ccb28d.js"><link rel="prefetch" href="/dcl-escape-room-tutorial/assets/js/11.c04cc9b6.js"><link rel="prefetch" href="/dcl-escape-room-tutorial/assets/js/12.eda373ce.js"><link rel="prefetch" href="/dcl-escape-room-tutorial/assets/js/13.bb967b29.js"><link rel="prefetch" href="/dcl-escape-room-tutorial/assets/js/14.b323f334.js"><link rel="prefetch" href="/dcl-escape-room-tutorial/assets/js/15.4fe8dcbd.js"><link rel="prefetch" href="/dcl-escape-room-tutorial/assets/js/16.6c78065a.js"><link rel="prefetch" href="/dcl-escape-room-tutorial/assets/js/3.cacf5f18.js"><link rel="prefetch" href="/dcl-escape-room-tutorial/assets/js/4.1ed9fda6.js"><link rel="prefetch" href="/dcl-escape-room-tutorial/assets/js/5.53963f01.js"><link rel="prefetch" href="/dcl-escape-room-tutorial/assets/js/7.0430d6cf.js"><link rel="prefetch" href="/dcl-escape-room-tutorial/assets/js/8.889280b3.js"><link rel="prefetch" href="/dcl-escape-room-tutorial/assets/js/9.5b106a36.js">
    <link rel="stylesheet" href="/dcl-escape-room-tutorial/assets/css/0.styles.88479a94.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/dcl-escape-room-tutorial/" class="home-link router-link-active"><!----> <span class="site-name">dcl-escape-room-tutorial</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/HardlyDifficult/dcl-escape-room-tutorial" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://escape-room.decentraland1.now.sh" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Demo
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/HardlyDifficult/dcl-escape-room-tutorial" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://escape-room.decentraland1.now.sh" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Demo
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/dcl-escape-room-tutorial/" class="sidebar-link">Home</a></li><li><a href="/dcl-escape-room-tutorial/00-setup.html" class="sidebar-link">00: Setup</a></li><li><a href="/dcl-escape-room-tutorial/01-door.html" class="active sidebar-link">01: Door</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dcl-escape-room-tutorial/01-door.html#add-a-door" class="sidebar-link">Add a door</a></li><li class="sidebar-sub-header"><a href="/dcl-escape-room-tutorial/01-door.html#animate-opening-the-door" class="sidebar-link">Animate opening the door</a></li><li class="sidebar-sub-header"><a href="/dcl-escape-room-tutorial/01-door.html#play-a-sound-effect-on-open" class="sidebar-link">Play a sound effect on open</a></li><li class="sidebar-sub-header"><a href="/dcl-escape-room-tutorial/01-door.html#refactor" class="sidebar-link">Refactor</a></li></ul></li><li><a href="/dcl-escape-room-tutorial/02-button.html" class="sidebar-link">02: Button</a></li><li><a href="/dcl-escape-room-tutorial/03-plants.html" class="sidebar-link">03-plants</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_01-door"><a href="#_01-door" aria-hidden="true" class="header-anchor">#</a> 01: Door</h1> <p>Start with the <a href="https://github.com/HardlyDifficult/dcl-escape-room-tutorial/tree/master/01-door-playground" target="_blank" rel="noopener noreferrer">01-door-playground<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> folder, it has the default scene from 00-setup and the model &amp; sound files for this room.</p> <p>Resources:</p> <ul><li><a href="https://github.com/HardlyDifficult/dcl-escape-room-tutorial/tree/master/01-door-complete" target="_blank" rel="noopener noreferrer">01-door-complete<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>: this room's implementation</li> <li><a href="https://github.com/HardlyDifficult/dcl-escape-room-tutorial/tree/master/01-door-refactored" target="_blank" rel="noopener noreferrer">01-door-refactored<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>: this room after introducing file separation</li></ul> <h2 id="add-a-door"><a href="#add-a-door" aria-hidden="true" class="header-anchor">#</a> Add a door</h2> <center><iframe width="560" height="315" src="https://www.youtube.com/embed/aonEnpfKIX8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></center> <p>Inside <code>game.ts</code> add the following after the base scene code:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token comment">// Add an entity for the door</span>
<span class="token keyword">const</span> door <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
engine<span class="token punctuation">.</span><span class="token function">addEntity</span><span class="token punctuation">(</span>door<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Give it a model and move it into place</span>
door<span class="token punctuation">.</span><span class="token function">addComponent</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">GLTFShape</span><span class="token punctuation">(</span><span class="token string">&quot;models/room1/Puzzle01_Door.glb&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
door<span class="token punctuation">.</span><span class="token function">addComponent</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Transform</span><span class="token punctuation">(</span><span class="token punctuation">{</span> position<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Vector3</span><span class="token punctuation">(</span><span class="token number">21.18</span><span class="token punctuation">,</span> <span class="token number">10.8</span><span class="token punctuation">,</span> <span class="token number">24.5</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This adds a door and positions it in the doorway for the first room.</p> <h2 id="animate-opening-the-door"><a href="#animate-opening-the-door" aria-hidden="true" class="header-anchor">#</a> Animate opening the door</h2> <center><iframe width="560" height="315" src="https://www.youtube.com/embed/QHgOIh04ukY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></center> <p>Add an Animator and play <code>Door_Open</code> when the door is clicked:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token comment">// Add an Animator to play clips inside the model file, created by the artist</span>
door<span class="token punctuation">.</span><span class="token function">addComponent</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Animator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// This model has an &quot;Open&quot; animation that when played should happen once</span>
<span class="token comment">// and then stop moving</span>
door
  <span class="token punctuation">.</span><span class="token function">getComponent</span><span class="token punctuation">(</span>Animator<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">addClip</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AnimationState</span><span class="token punctuation">(</span><span class="token string">&quot;Door_Open&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> looping<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// When the player clicks on the door, open it!</span>
<span class="token keyword">let</span> isDoorOpen <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
door<span class="token punctuation">.</span><span class="token function">addComponent</span><span class="token punctuation">(</span>
  <span class="token keyword">new</span> <span class="token class-name">OnClick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token parameter"><span class="token keyword">void</span></span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Play the animation</span>
    door
      <span class="token punctuation">.</span><span class="token function">getComponent</span><span class="token punctuation">(</span>Animator<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">getClip</span><span class="token punctuation">(</span><span class="token string">&quot;Door_Open&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="play-a-sound-effect-on-open"><a href="#play-a-sound-effect-on-open" aria-hidden="true" class="header-anchor">#</a> Play a sound effect on open</h2> <center><iframe width="560" height="315" src="https://www.youtube.com/embed/l7NdwToC5tg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></center> <p>And an audio source to play a sound effect when opened:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token comment">// Add an AudioSource to play a squeak as the door opens</span>
door<span class="token punctuation">.</span><span class="token function">addComponent</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AudioSource</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AudioClip</span><span class="token punctuation">(</span><span class="token string">&quot;sounds/door_squeak.mp3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Update the OnClick event handler to play the sound, once, when the door opens:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>    <span class="token comment">// Track if the door has already been opened so we don't play the animation twice</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isDoorOpen<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      isDoorOpen <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      
      door
        <span class="token punctuation">.</span><span class="token function">getComponent</span><span class="token punctuation">(</span>Animator<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">getClip</span><span class="token punctuation">(</span><span class="token string">&quot;Door_Open&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// And the sound effect</span>
      door<span class="token punctuation">.</span><span class="token function">getComponent</span><span class="token punctuation">(</span>AudioSource<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">playOnce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

</code></pre></div><p>Audio is 3d, meaning that where the sound originates is relevant in terms of how loud it is for the user and if it's coming from the left or the right.</p> <h2 id="refactor"><a href="#refactor" aria-hidden="true" class="header-anchor">#</a> Refactor</h2> <center><iframe width="560" height="315" src="https://www.youtube.com/embed/ihvRnrNusas" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></center> <p>Separate the game into seperate scene files.  This file separation makes it easy to focus on just one room at a time.</p> <p>Create <code>scenes/room1.ts</code> with:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token comment">// Export as a function for game.ts to call in order to construct this room</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">CreateRoom1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>And cut the room 1 code from <code>game.ts</code> and paste it in that function.</p> <p>Update <code>game.ts</code> to include the new file and call <code>CreateRoom1</code>:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> CreateRoom1 <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./scenes/room1&quot;</span><span class="token punctuation">;</span>

<span class="token operator">...</span>

<span class="token comment">// Room 1 was moved to another file</span>
<span class="token function">CreateRoom1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/dcl-escape-room-tutorial/00-setup.html" class="prev">
          00: Setup
        </a></span> <span class="next"><a href="/dcl-escape-room-tutorial/02-button.html">
          02: Button
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/dcl-escape-room-tutorial/assets/js/app.70dca567.js" defer></script><script src="/dcl-escape-room-tutorial/assets/js/2.709dec3e.js" defer></script><script src="/dcl-escape-room-tutorial/assets/js/6.dcdbada1.js" defer></script>
  </body>
</html>
